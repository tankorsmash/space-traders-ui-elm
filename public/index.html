<!DOCTYPE html>
<html>
  <head>
    <style>
      * {
        box-sizing: border-box;
        color: var(--primary-color);
        background-color: var(--secondary-color);
        border-color: var(--primary-color);
      }

      body {
        margin: 0;
        font-family: "Gill Sans", "Gill Sans MT", Calibri, "Trebuchet MS",
          sans-serif;
      }

      dialog {
        color: var(--primary-color);
        background-color: var(--secondary-color);
      }

      .theme-1 {
        --primary-color: teal;
        --secondary-color: #fff9e1;
      }

      .theme-2 {
        --primary-color: cyan;
        --secondary-color: #9e4c34;
      }

      .theme-3 {
        --primary-color: #0f5166;
        --secondary-color: skyblue;
      }

      .theme-4 {
        --primary-color: indigo;
        --secondary-color: #c4ccbb;
      }

      .theme-5 {
        --primary-color: orangered;
        --secondary-color: #480e12;
      }

      .theme-6 {
        --primary-color: orange;
        --secondary-color: #4e1f2b;
      }

      .theme-7 {
        --primary-color: #1c4c60;
        --secondary-color: orange;
      }

      .theme-8 {
        --primary-color: teal;
        --secondary-color: #e7ffe7;
      }

      .theme-9 {
        --primary-color: cyan;
        --secondary-color: #615564;
      }

      .theme-10 {
        --primary-color: #615564;
        --secondary-color: cyan;
      }
    </style>
  </head>
  <body>
    <script src="elm.js"></script>
    <script>
      const TOKEN_KEY = "token";
      const SETTINGS_KEY = "settings";

      const maybeToken = localStorage.getItem(TOKEN_KEY);
      let maybeSettings = localStorage.getItem(SETTINGS_KEY);

      if (maybeSettings) {
        maybeSettings = JSON.parse(maybeSettings);
      }

      const app = Elm.Main.init({
        flags: { accessToken: maybeToken, settings: maybeSettings },
      });

      app.ports.setToken.subscribe(function (token) {
        localStorage.setItem(TOKEN_KEY, token);
      });

      app.ports.clearToken.subscribe(function () {
        localStorage.removeItem(TOKEN_KEY);
      });

      app.ports.storeSettings.subscribe(function (settings) {
        localStorage.setItem(SETTINGS_KEY, JSON.stringify(settings));
      });

      app.ports.openModal.subscribe(function (id) {
        const modalEl = document.getElementById(id);

        modalEl?.showModal();
      });

      app.ports.closeModal.subscribe(function (id) {
        const modalEl = document.getElementById(id);

        modalEl?.close();
      });
    </script>
  </body>
</html>
